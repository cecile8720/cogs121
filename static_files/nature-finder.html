<!DOCTYPE html>
<html>

<head>
  <title>Nature Finder</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="css/nature-finder.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://www.gstatic.com/firebasejs/5.11.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyBU1zQlcACqaOhTPhsPNyQkh1RYFf2cdYU",
      authDomain: "collegeburnouts.firebaseapp.com",
      databaseURL: "https://collegeburnouts.firebaseio.com",
      projectId: "collegeburnouts",
      storageBucket: "collegeburnouts.appspot.com",
      messagingSenderId: "890814837618"
    };
    firebase.initializeApp(config);
  </script>
</head>

<body>
	<a name="top"></a>

		<!-- SIDEBAR-->
		<div id="sideMenu" class="sidenav">
		  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
		  <a href="#">About</a>
		  <a href="#">Services</a>
		  <a href="#">Clients</a>
		  <a href="#">Log Out</a>
		</div>  
	  
    	<!-- HEADER -->
		<div class="header">
			<div class="button button-left menu"><span onclick="openNav()"><img id="hamburger" class="icon header" src="img/hamburger-menu.png"></span></div>
			<div class="title">
        		<div id="current-location">Naturous</div>
      		</div>
		</div>

	<hr>

	<!--calling the api link directly, may not work-->
	<!--script src="https://api.everypixel.com/v1/keywords"></script-->
	<!--calling the python file?-->
	<!--div><span id= "naturefinder"><a href="nature-finder.py"></a></div-->
	<!--example code, replace variables. To trigger the ajax when the link is clicked-->
	<!--a href="javascript:keyword"('{{ post.language }}', '{{ g.locale }}', '#post{{ post.id }}', '#translation{{ post.id }}', '#loading{{ post.id }}');"></a>
	<script>
		function keyword(sourceImg, naturefinder, sourceId, destId, loadingId) {
			$(destId).hide();
			//$(loadingId).show();
			$.post('/keyword', {
				text: $(sourceId).text(),
				sourceImg: sourceImg,
				naturefinder: naturefinder
			}).done(function(keyworded) {
				$(destId).text(translated['text'])
				$(loadingId).hide();
				$(destId).show();
			}).fail(function() {
				$(destId).text("{{ _('Error: Could not contact server.') }}");
				$(loadingId).hide();
				$(destId).show();
			});
		}
	</script-->
	<!--jQuery convention for running when the document has been fully loaded-->
	<script type="text/javascript">
		$(document).ready(() => {
			console.log('Ready to accept image')
			//create a root reference
			const storageRef = firebase.storage().ref();
			//Create a reference to example image
			const exampleRef = storageRef.child('26863598b8bec4c49bea8cf6f805002d.jpg');
			//Create a reference to 'images/example'
			const exampleImagesRef = storageRef.child('images/26863598b8bec4c49bea8cf6f805002d.jpg');			
			//File name-- will have to change
			const file = '26863598b8bec4c49bea8cf6f805002d.jpg';
			const metadata = {
				contentType: 'image/jpeg'
			};
			//Upload file and metadata to the object but put isnt a valid firebase command
			const uploadImg = storageRef.child('images/'+ file /*'26863598b8bec4c49bea8cf6f805002d.jpg'*/).put(file, metadata).then(function(snapshot){
				console.log('Uploaded a file!');
			});
			//Listen for state changes, errors, and completion of the upload.
			uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, //or 'state_changed'
			function(snapshot){
				const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
				console.log('Upload is ' + progress + '% done');
				switch (snapshot.state) {
					case firebase.storage.TaskState.PAUSED: // or 'paused'
						console.log('Upload is paused');
						break;
					case firebase.storage.TaskState.RUNNING: // or 'running'
						console.log('Upload is running');
						break;
				}
				}, function(error) {
					//Handle unsuccessful uploads
					switch (error.code){
						case 'storage/unauthorized':
							//user doesn't have permission to access the object
							break;
						case 'storage/canceled':
							//user canceled the upload
							break;
						case 'storage/unknown':
							//Unknown error occurred. inspect error.serverResponse
							break;
					}
				},
				function() {
					//Handle successful uploads on complete
					uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL){
						console.log('File available at ', downloadURL);
					});
			});
			$('#insertImage').click(() => {
				//coding the interaction, should read url and change the image
				$.ajax({
					url:'https://firebasestorage.googleapis.com/v0/b/collegeburnouts.appspot.com/o/26863598b8bec4c49bea8cf6f805002d.jpg?alt=media&token=2f8fa8c5-78c5-48ee-a4d1-84d9f9eae4a0',
					type: 'PUT',
					dataType: 'json',
					success: (data) => {
					console.log('Accepting image'), 
					imgURL = document.querySelector('').src, //probably not using this right
					$('#Image_Bin').html(imgURL)
					}
				});
			})
		});
	</script>


	<!-- Side Menu JS -->
	<script>
		function openNav() {
			document.getElementById("sideMenu").style.width = "45%";
		}	
		function closeNav() {
			document.getElementById("sideMenu").style.width = "0";
		}
	</script>

	<div class="page current content">
	<div class="content">
	<div style="width: 400px; height: 400px; border: 1px solid #000;" class="Image_Bin">
	<!--p>Upload your image</p-->
	</div>
	<form method="PUT" enctype="multipart/form-data" id="insertImage">
		<input type="file" accept="image/*">
		<input type="submit" value="Upload" id="analyze">
	</form>
	<!--script>
		function display(sw) {
			var pic;
			if (sw == 1){

			}
		}
	</script-->
	<!--keywords should be displayed here-->
	<div class="keyWords"></div>
	<!-- Make sure this is at the bottom always:
       Allows space between last thing on the page and navbar -->
	<div class="clear"></div>
	<!-- Navbar -->
	<div class="navbar">
			<a href="index.html"><img src="https://img.icons8.com/ios/40/000000/home-page.png"></a>
			<a href="map.html"><img src="https://img.icons8.com/wired/40/000000/map.png"></a>
			<a href="trail-list.html"><img src="https://img.icons8.com/ios/40/000000/earth-element.png"></a>
			<a href="nature-finder.html"><img src="https://img.icons8.com/wired/43/000000/leaf.png"></a>
	</div>
	</div>
	</div>
</body>

</html>
